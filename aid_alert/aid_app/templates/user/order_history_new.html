{% extends 'user/base_user.html' %}
{% load static %}

{% block page_title %}Order History{% endblock %}

{% block user_css %}
<link rel="stylesheet" href="{% static 'css/user/order_history.css' %}">
{% endblock %}

{% block user_content %}
<div class="history-container">
    <!-- Stats Overview -->
    <div class="stats-overview">
        <div class="glass-card stat-card">
            <div class="stat-icon">
                <span class="material-icons-round">shopping_cart</span>
            </div>
            <div class="stat-info">
                <h3>Total Orders</h3>
                <p class="stat-value">{{ stats.total }}</p>
            </div>
        </div>
        <div class="glass-card stat-card">
            <div class="stat-icon">
                <span class="material-icons-round">local_shipping</span>
            </div>
            <div class="stat-info">
                <h3>In Transit</h3>
                <p class="stat-value">{{ stats.in_transit }}</p>
            </div>
        </div>
        <div class="glass-card stat-card">
            <div class="stat-icon">
                <span class="material-icons-round">check_circle</span>
            </div>
            <div class="stat-info">
                <h3>Delivered</h3>
                <p class="stat-value">{{ stats.delivered }}</p>
            </div>
        </div>
        <div class="glass-card stat-card">
            <div class="stat-icon">
                <span class="material-icons-round">pending</span>
            </div>
            <div class="stat-info">
                <h3>Processing</h3>
                <p class="stat-value">{{ stats.processing }}</p>
            </div>
        </div>
    </div>

    <!-- ... (rest of filtering UI) ... -->
</div>
{% endblock %}

{% block user_js %}
<script src="{% static 'js/user/order_history.js' %}"></script>
<script>
    const ordersData = [
        {% for order in orders %}
    {
        id: '{{ order.order_id }}',
            db_id: { { order.id } },
        date: '{{ order.created_at|date:"Y-m-d" }}',
            displayDate: '{{ order.created_at|date:"M d, Y" }}',
                items: [
                    { name: '{{ order.product.name|escapejs }}', quantity: {{ order.quantity }}, price: { { order.product.price |default: 0 } } }
            ],
    total: { { order.total_price |default: 0 } },
    status: '{{ order.status }}'
        },
    {% endfor %}
    ];

    document.addEventListener('DOMContentLoaded', function () {
        initOrderHistory(ordersData);
    });
</script>
{% endblock %}